---
title: "ESM 204 - Assignment 3"
author: "Jamie Miller"
date: "May 18, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(stargazer) # To make nicely formatted table of regression analysis
```

```{r, include = FALSE}
# Read in data
whales <- read_csv("HW3Data.csv")
```


1. Create a linear probability model that predicts a respondent’s probability of voting ‘yes’ on the ballot based on their age, income, NEP score, the risk reduction offered by the program, and the cost of the program to that respondent. Show the model and interpret the regression coefficients.
```{r}
# Regression - linear probability model
vote_lm <- lm(vote ~ risk + bid + NEP + income + age, data = whales)
vote_lm

# vote = 0.1196977 + 0.0007445(risk) - 0.0010699(bid) + 0.0158639(NEP) + 0.0088282(incomeone_percent) + 0.0027386(incomepoor) + 0.0074891(incomerich) + 0.0467922(incomevery_rich) + 0.0099816(agetofifty) - 0.0201190(agetoforty) - 0.0162261(agetosixty) + 0.0204401(agetothirty)

# (1) “risk”: level of risk reduction, (2) “bid”: annual payment for the household, (3) “vote”: 1 is yes, 0 is no, (4)”NEP” : measure of environmental concern (5)”income”: categorical variable for income level, (6)”age”: categorical variable for age.

summary(vote_lm) # Not sure this is needed, but here it is.

```




2. Based on this regression, what can you say about the value of a single prevented whale death? (Hint: Think about how risk reduction for all whales translates into the number of whale deaths avoided)

```{r}
# This is a first attempt at question 2 based on the slack thread. I literally have no idea why it needs to be done this way.

# Calculate risk reduction per whale by dividung 20% risk by 5 whales, even though the wording seems to suggest that it is a 20% redutction for a whale. 

risk_per_whale <- 0.20/5 # 20% risk reduction / 5 whales = 4% risk reduction per whale
# multiply each coefficient by 0.04

# Equation
# vote = 0.1196977 + 0.0007445*(risk) - 0.0010699*(bid) + 0.0158639*(NEP) + 0.0088282*(incomeone_percent) + 0.0027386*(incomepoor) + 0.0074891*(incomerich) + 0.0467922*(incomevery_rich) + 0.0099816*(agetofifty) - 0.0201190*(agetoforty) - 0.0162261*(agetosixty) + 0.0204401*(agetothirty)

prob_vote <- 0.1196977 + 0.0007445*(risk_per_whale) - 0.0010699*(risk_per_whale) + 0.0158639*(risk_per_whale) + 0.0088282*(risk_per_whale) + 0.0027386*(risk_per_whale) + 0.0074891*(risk_per_whale) + 0.0467922*(risk_per_whale) + 0.0099816*(risk_per_whale) - 0.0201190*(risk_per_whale) - 0.0162261*(risk_per_whale) + 0.0204401*(risk_per_whale)

#####################

# Calculate mean vote coefficient
mean_vote <- whales %>% 
  summarize(mean = mean(vote))
mean_vote

# mean values of all votes = 0.714; Sam said to use this value
# Chris said to use 0.5

#####################

# Algebra
# vote - vote + 0.0010699(bid) = 0.1196977 + 0.0007445(risk) - 0.0010699(bid) + 0.0158639(NEP) + 0.0088282(incomeone_percent) + 0.0027386(incomepoor) + 0.0074891(incomerich) + 0.0467922(incomevery_rich) + 0.0099816(agetofifty) - 0.0201190(agetoforty) - 0.0162261(agetosixty) + 0.0204401(agetothirty) - vote + 0.0010699(bid)

# 0.0010699(bid) = 0.1196977 + 0.0007445(risk) - 0.714(vote) + 0.0158639(NEP) + 0.0088282(incomeone_percent) + 0.0027386(incomepoor) + 0.0074891(incomerich) + 0.0467922(incomevery_rich) + 0.0099816(agetofifty) - 0.0201190(agetoforty) - 0.0162261(agetosixty) + 0.0204401(agetothirty) 

prob_bid  <- (0.1196977 + 0.0007445*(risk_per_whale) - (0.5)*(risk_per_whale) + 0.0158639*(risk_per_whale) + 0.0088282*(risk_per_whale) + 0.0027386*(risk_per_whale) + 0.0074891*(risk_per_whale) + 0.0467922*(risk_per_whale) + 0.0099816*(risk_per_whale) - 0.0201190*(risk_per_whale) - 0.0162261*(risk_per_whale) + 0.0204401*(risk_per_whale))/0.0010699
prob_bid

# I don't even know what this is supposed to mean and it has nothing to do with what others got.
# No idea. Not even the slightest.

```

```{r}
1/0.0010699
```




3. Pick three arbitrary respondents. For each of those respondents, estimate their WTP for a VSR program offering 60% risk reduction.


4. Now repeat this process and estimate the mean WTP for a VSR program offering 60% risk reduction among Santa Barbara County households.


5. If there are 150,000 households in Santa Barbara County, estimate the total benefit of a VSR program to these households.


6. Based only on these benefits, do the benefits of the VSR program outweigh the costs?


7. Suppose the price of a carbon credit is \$Z per ton, at what price Z* will the shipping industry decide to adopt the VSR for purely self-interested reasons? (Note: if ships voluntarily reduce speed, then the \$7 million cost (noted above) of implementing the VSR would be avoided)


8. Now suppose the carbon credit price is exactly Z*, so all ships voluntarily reduce speed to achieve the 60% risk reduction. Approximately how many whales would be saved by this? What would be the social value of allowing ships to enter the carbon trading market?




